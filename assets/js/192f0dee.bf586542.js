"use strict";(self.webpackChunkaniapi_docs=self.webpackChunkaniapi_docs||[]).push([[808],{5324:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var r=n(5861),a=n(7757),c=n.n(a),o=n(7294),i=n(3575);function s(){var e;try{(e=JSON.parse(window.localStorage.getItem("AUTH_USER")))||window.location.replace("/login")}catch(s){}(0,o.useEffect)((0,r.Z)(c().mark((function e(){var n,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.fromEntries(new URLSearchParams(window.location.search).entries()),(r=window.localStorage.getItem("MAL_CHALLENGE"))!==n.state&&window.location.replace("/login"),e.next=5,t(n.code,r);case 5:return o=e.sent,e.next=8,a(o.token,o.id);case 8:case"end":return e.stop()}}),e)}))),[]);var t=function(){var e=(0,r.Z)(c().mark((function e(t,r){var a,o,i,s,p,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in e.prev=0,o=[],a={client_id:"747af82869e036215653a76eebe5e10a",client_secret:"172c0804a3f452ae57e35fb9bbca0dad92213b9a182fac723e94d9b73883d855",grant_type:"authorization_code",code:t,code_verifier:r})o.push(encodeURIComponent(i)+"="+encodeURIComponent(a[i]));return o=o.join("&"),e.next=7,fetch("https://cors-anywhere.herokuapp.com/myanimelist.net/v1/oauth2/token",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:o});case 7:return s=e.sent,e.next=10,s.json();case 10:return p=e.sent,e.next=13,n(p.access_token);case 13:return u=e.sent,e.abrupt("return",{id:u,token:p.refresh_token});case 17:e.prev=17,e.t0=e.catch(0),window.location.replace("/profile#trackers");case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}(),n=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://cors-anywhere.herokuapp.com/api.myanimelist.net/v2/users/@me",{method:"GET",headers:{Authorization:"Bearer "+t,Accept:"application/json","Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r.id);case 10:e.prev=10,e.t0=e.catch(0),window.location.replace("/profile#trackers");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),a=function(){var t=(0,r.Z)(c().mark((function t(n,r){var a,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.aniapi.com/v1/user",{method:"POST",headers:{Authorization:"Bearer "+e.access_token,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e.id,mal_id:r,mal_token:n})});case 2:return a=t.sent,t.next=5,a.json();case 5:200===(o=t.sent).status_code&&(e.has_mal=o.data.has_mal,window.localStorage.setItem("AUTH_USER",JSON.stringify(e))),window.location.replace("/profile#trackers");case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return o.createElement(i.Z,{title:"MyAnimeList"},o.createElement("main",null,o.createElement("div",{className:"container margin-vert--lg"},o.createElement("h1",null,"Please wait..."))))}}}]);